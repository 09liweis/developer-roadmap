import{j as e}from"./jsx-runtime.BPj4-Rfu.js";import{g as X}from"./browser.DS5mYzWA.js";import{r as l}from"./index.SSXOyoI7.js";import{a as k,d as E}from"./http.BfNEAXh_.js";import{p as u}from"./page.C3ddTGlS.js";import{u as Y}from"./index.zDCl-MiS.js";import{b as ee}from"./team.B3mFytyj.js";import{u as se}from"./use-toast.CK2mpur1.js";import{U as ae,S as te}from"./SelectRoadmapModal.D-wCsnxL.js";import{M as re}from"./Modal.CKHmOEZZ.js";import{M as oe}from"./map.S6mQRSrY.js";import{S as M}from"./shapes.CVlObevd.js";import{C as ie}from"./CreateRoadmapModal.YLaok2Kw.js";import{u as le}from"./use-outside-click.BWzraQDw.js";import{M as ne}from"./MoreVerticalIcon.C2zGsXKe.js";import{E as de,L,S as me}from"./ShareOptionsModal.Cm3kAP06.js";import{T as ce}from"./trash-2.ZZ91sqU8.js";import{c as pe}from"./classname.B_pfcvI6.js";import{R as ue}from"./RoadmapIcon.DUeTpdPA.js";import{S as _}from"./square-pen.IH14wLcc.js";import{E as O}from"./external-link.B8tZusyt.js";import{c as F}from"./createLucideIcon.BBd35SSe.js";import{G as xe}from"./globe.BXgnMOJ5.js";import{U}from"./users.qRtzBGpT.js";import"./jwt.DjKu0S3o.js";import"./index.CEvxOxeV.js";import"./index.Bhz7cRIx.js";import"./toast.BGQI3kl5.js";import"./index.es.B1RiJbf6.js";import"./Spinner.B1Yt5gOc.js";import"./resource-progress.CaCjaD4j.js";import"./roadmap.SDi3zlny.js";/* empty css                       */import"./use-keydown.DCIacX8c.js";import"./dom.DTPLKm7E.js";import"./x.wVDa2hJ0.js";import"./loader-circle.C4evEXYn.js";import"./use-copy-text.i66JXdki.js";import"./user-round-plus.7HAn8_3x.js";import"./check.Bz-udI6N.js";import"./copy.QmJc480g.js";import"./users-round.CqESJeW4.js";import"./circle-check-big.CVZOTjPY.js";import"./linkedin.C82Q96ee.js";import"./bundle-mjs.CpAuaXBl.js";/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=F("PackageMinus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=F("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);function ge(o){const{onClose:t,showDefaultRoadmapsModal:i,showCreateCustomRoadmapModal:d}=o;return e.jsxs(re,{onClose:t,bodyClassName:"p-4",children:[e.jsx("h2",{className:"mb-0.5 text-left text-2xl font-semibold",children:"Pick an Option"}),e.jsx("p",{className:"text-left text-sm text-gray-500 mb-4",children:"Choose from default roadmaps or create from scratch."}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{className:"text-base flex items-center rounded-md border border-gray-300 p-2 px-4 text-left font-medium hover:bg-gray-100",onClick:i,children:[e.jsx(oe,{className:"mr-2 inline-block",size:20}),"Use a Default Roadmap"]}),e.jsxs("button",{className:"text-base flex items-center rounded-md border border-gray-300 p-2 px-4 text-left font-medium hover:bg-gray-100",onClick:d,children:[e.jsx(M,{className:"mr-2 inline-block",size:20}),"Create from Scratch"]})]})]})}function I(o){const{onDelete:t,onUpdateSharing:i,onCustomize:d}=o,m=l.useRef(null),[c,n]=l.useState(!1);return le(m,()=>{n(!1)}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{disabled:!1,onClick:()=>n(!c),className:"hidden items-center opacity-60 transition-opacity hover:opacity-100 disabled:cursor-not-allowed disabled:opacity-30 sm:flex",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsxs("button",{disabled:!1,onClick:()=>n(!c),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-none sm:hidden",children:[e.jsx(de,{size:14}),"Options"]}),c&&e.jsx("div",{ref:m,className:"align-right absolute right-auto top-full z-50 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md sm:right-0",children:e.jsxs("ul",{children:[i&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{n(!1),i()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(L,{size:14,className:"mr-2"}),"Sharing"]})}),d&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{n(!1),d()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(M,{size:14,className:"mr-2"}),"Customize"]})}),t&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{n(!1),t()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(ce,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function ps(){const{t:o}=X(),t=Y(ee),i=se(),[d,m]=l.useState(!0),[c,n]=l.useState(!1),[V,S]=l.useState(!1),[G,v]=l.useState(!1),[w,C]=l.useState(""),[f,q]=l.useState(),[g,x]=l.useState([]),[B,Z]=l.useState([]),[p,R]=l.useState(null);async function T(){const{error:s,response:a}=await k("/pages.json");if(s){i.error(s.message||"Something went wrong");return}if(!a)return[];const r=a.filter(N=>N.group==="Roadmaps").sort((N,W)=>N.title==="Android"?1:N.title.localeCompare(W.title));return Z(r),a}async function H(s){const{response:a,error:r}=await k(`https://api.roadmap.sh/v1-get-team/${s}`);if(r||!a){i.error("Error loading team"),window.location.href="/account";return}q(a)}async function A(s){const{error:a,response:r}=await k(`https://api.roadmap.sh/v1-get-team-resource-config/${s}`);if(a||!Array.isArray(r)){console.error(a);return}x(r)}l.useEffect(()=>{o&&(m(!0),Promise.all([H(o),A(o),T()]).finally(()=>{u.set(""),m(!1)}))},[o]);async function J(s){if(!f?._id)return;i.loading("Deleting roadmap"),u.set("Deleting roadmap from team");const{error:a,response:r}=await E(`https://api.roadmap.sh/v1-delete-team-resource-config/${f._id}`,{resourceId:s,resourceType:"roadmap"});if(a||!r){i.error(a?.message||"Something went wrong");return}i.success("Roadmap removed"),x(r)}async function P(s){if(!o)return;i.loading("Adding roadmap"),u.set("Adding roadmap"),m(!0);const{error:a,response:r}=await E(`https://api.roadmap.sh/v1-update-team-resource-config/${o}`,{teamId:o,resourceId:s,resourceType:"roadmap",removed:[]});if(a||!r){i.error(a?.message||"Error adding roadmap");return}x(r),i.success("Roadmap added")}async function b(s){u.set("Removing roadmap"),J(s).finally(()=>{u.set("")})}if(l.useEffect(()=>{function s(a){const{roadmapId:r}=a?.detail;r&&(T().finally(()=>{}),P(r).finally(()=>{u.set("")}))}return window.addEventListener("custom-roadmap-created",s),()=>{window.removeEventListener("custom-roadmap-created",s)}},[]),!f)return null;const z=c&&e.jsx(ge,{onClose:()=>n(!1),showDefaultRoadmapsModal:()=>{S(!0),n(!1)},showCreateCustomRoadmapModal:()=>{v(!0),n(!1)}}),$=V&&e.jsx(te,{onClose:()=>S(!1),teamResourceConfig:g,allRoadmaps:B,teamId:o,onRoadmapAdd:s=>{P(s).finally(()=>{u.set("")})},onRoadmapRemove:s=>{confirm("Are you sure you want to remove this roadmap?")&&b(s).finally(()=>{})}}),D=G&&e.jsx(ie,{teamId:o,onClose:()=>{v(!1)},onCreated:()=>{A(o).finally(()=>null),v(!1)}}),y=g.filter(s=>s.isCustomResource&&!s.topics),j=g.filter(s=>s.isCustomResource&&s.topics),h=g.filter(s=>!s.isCustomResource);if(!(j.length>0||h.length>0||y.length>0&&t)&&!d)return e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[z,$,D,e.jsx(ue,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:t?"Add a roadmap to start tracking your team":"Ask your team admin to add some roadmaps"}),t&&e.jsx("button",{className:"mt-4 rounded-lg bg-black px-4 py-2 font-medium text-white hover:bg-gray-900",onClick:()=>n(!0),children:"Add roadmap"})]});const K=w&&e.jsx(ae,{onClose:()=>C(""),resourceId:w,resourceType:"roadmap",teamId:f?._id,setTeamResourceConfig:x,defaultRemovedItems:h.find(s=>s.resourceId===w)?.removed||[]}),Q=p&&e.jsx(me,{description:p.description,visibility:p.visibility,sharedTeamMemberIds:p.sharedTeamMemberIds,sharedFriendIds:p.sharedFriendIds,teamId:o,roadmapId:p.resourceId,onShareSettingsUpdate:s=>{x(a=>a.map(r=>r.resourceId!==p.resourceId?r:{...r,...s}))},onClose:()=>R(null)});return e.jsxs("div",{children:[z,$,D,K,Q,t&&y.length>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsxs("h3",{className:"flex w-full items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{className:"flex",children:"Placeholder Roadmaps"}),e.jsxs("span",{className:"normal-case",children:["Total ",y.length," roadmap(s)"]})]})}),e.jsx("div",{className:"flex flex-col divide-y rounded-md border",children:y.map(s=>e.jsxs("div",{className:"grid grid-cols-1 p-2.5 sm:grid-cols-[auto_173px]",children:[e.jsxs("div",{className:"mb-3 grid sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsx("span",{className:"text-xs italic leading-none text-gray-400/60",children:"Placeholder roadmap"})]}),t&&e.jsxs("div",{className:"flex items-center justify-start gap-2 sm:justify-end",children:[e.jsx(I,{onUpdateSharing:()=>{R(s)},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&b(s.resourceId).finally(()=>{})}}),e.jsxs("a",{href:`https://draw.roadmap.sh/${s.resourceId}`,className:"flex gap-2 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-none",target:"_blank",children:[e.jsx(_,{className:"inline-block h-4 w-4"}),"Create Roadmap"]})]})]},s.resourceId))})]}),j.length>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsxs("h3",{className:"flex w-full items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{className:"flex",children:"Custom Roadmaps"}),e.jsxs("span",{className:"normal-case",children:["Total ",j.length," roadmap(s)"]})]})}),e.jsx("div",{className:"flex flex-col divide-y rounded-md border",children:j.map(s=>{const a=`https://draw.roadmap.sh/${s.resourceId}`;return e.jsxs("div",{className:pe("grid grid-cols-1 p-2.5",t?"sm:grid-cols-[auto_172px]":"sm:grid-cols-[auto_110px]"),children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[e.jsx(ye,{visibility:s.visibility,sharedTeamMemberIds:s.sharedTeamMemberIds,sharedFriendIds:s.sharedFriendIds}),e.jsx("span",{className:"mx-2 font-semibold",children:"·"}),e.jsx(M,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.topics," topic"]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[t&&e.jsx(I,{onUpdateSharing:()=>{R(s)},onCustomize:()=>{window.open(a,"_blank")},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&b(s.resourceId).finally(()=>{})}}),e.jsxs("a",{href:`/r?id=${s.resourceId}`,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-none",target:"_blank",children:[e.jsx(O,{className:"inline-block h-4 w-4"}),"Visit"]}),t&&e.jsxs("a",{href:a,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-800 bg-gray-900 px-2.5 py-1.5 text-xs text-white hover:bg-gray-800 focus:outline-none",target:"_blank",children:[e.jsx(_,{className:"inline-block h-4 w-4"}),"Edit"]})]})]},s.resourceId)})})]}),h.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsxs("h3",{className:"flex w-full items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{className:"flex",children:"Default Roadmaps"}),e.jsxs("span",{className:"normal-case",children:["Total ",h.length," roadmap(s)"]})]})}),e.jsx("div",{className:"flex flex-col divide-y rounded-md border",children:h.map(s=>e.jsxs("div",{className:"grid grid-cols-1 p-3 sm:grid-cols-[auto_110px]",children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[s?.removed?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(he,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.removed.length," topics removed"]}),!s?.removed?.length&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{size:16,className:"mr-1 inline-block h-4 w-4"}),"No changes made"]})]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[t&&e.jsx(I,{onCustomize:()=>{C(s.resourceId)},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&b(s.resourceId).finally(()=>{})}}),e.jsxs("a",{href:`/${s.resourceId}`,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-none",target:"_blank",children:[e.jsx(O,{className:"inline-block h-4 w-4"}),"Visit"]})]})]},s.resourceId))})]}),t&&e.jsx("div",{className:"mt-5",children:e.jsx("button",{className:"block w-full rounded-md border border-dashed border-gray-300 py-2 text-sm transition-colors hover:border-gray-600 hover:bg-gray-50 focus:outline-0",onClick:()=>n(!0),children:"+ Add new Roadmap"})})]})}const be={public:{icon:xe,label:"Public"},me:{icon:L,label:"Only me"},team:{icon:U,label:"Team Member(s)"},friends:{icon:U,label:"Friend(s)"}};function ye(o){const{visibility:t,sharedTeamMemberIds:i=[],sharedFriendIds:d=[]}=o,{label:m,icon:c}=be[t];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 whitespace-nowrap text-xs font-normal",children:[e.jsx(c,{className:"inline-block h-3 w-3"}),e.jsxs("div",{className:"flex items-center",children:[t==="team"&&i?.length>0&&e.jsx("span",{className:"mr-1",children:i.length}),t==="friends"&&d?.length>0&&e.jsx("span",{className:"mr-1",children:d.length}),m]})]})}export{ps as TeamRoadmaps};
