import{j as e}from"./jsx-runtime.BPj4-Rfu.js";import{r as l}from"./index.SSXOyoI7.js";import{G as C}from"./GitHubIcon.HAaceZOS.js";import{s as j}from"./jwt.DjKu0S3o.js";import{a as I,h as A}from"./http.BfNEAXh_.js";import{S as L}from"./Spinner.B1Yt5gOc.js";const y="githubRedirectAt",v="githubLastPage";function G(m){const{isDisabled:u,setIsDisabled:t}=m,[s,a]=l.useState(!1),[g,c]=l.useState("");l.useEffect(()=>{const o=new URLSearchParams(window.location.search),i=o.get("code"),d=o.get("state"),p=o.get("provider");!i||!d||p!=="github"||(a(!0),t?.(!0),I(`https://api.roadmap.sh/v1-github-callback${window.location.search}`).then(({response:r,error:w})=>{if(!r?.token){const S=w?.message||"Something went wrong.";c(S),a(!1),t?.(!1);return}let n="/";const x=localStorage.getItem(y),h=localStorage.getItem(v);if(x&&h){const S=parseInt(x,10);Date.now()-S<30*1e3&&(n=h)}const b=localStorage.getItem("authRedirect");b&&(localStorage.removeItem("authRedirect"),n=b),localStorage.removeItem(y),localStorage.removeItem(v),j(r.token),window.location.href=n}).catch(r=>{c("Something went wrong. Please try again later."),a(!1),t?.(!1)}))},[]);const f=async()=>{a(!0),t?.(!0);const{response:o,error:i}=await I("https://api.roadmap.sh/v1-github-login");if(i||!o?.loginUrl){c(i?.message||"Something went wrong. Please try again later."),a(!1),t?.(!1);return}if(!["/login","/signup"].includes(window.location.pathname)){const d=["/respond-invite","/befriend","/r","/ai"].includes(window.location.pathname)?window.location.pathname+window.location.search:window.location.pathname;localStorage.setItem(y,Date.now().toString()),localStorage.setItem(v,d)}window.location.href=o.loginUrl};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"inline-flex h-10 w-full items-center justify-center gap-2 rounded border border-slate-300 bg-white p-2 text-sm font-medium text-black outline-none focus:ring-2 focus:ring-[#333] focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-60",disabled:s||u,onClick:f,children:[s?e.jsx(L,{className:"h-[18px] w-[18px]",isDualRing:!1}):e.jsx(C,{className:"h-[18px] w-[18px]"}),"Continue with GitHub"]}),g&&e.jsx("p",{className:"mb-2 mt-1 text-sm font-medium text-red-600",children:g})]})}function U(m){const{className:u}=m;return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 90 92",fill:"none",className:u,children:[e.jsx("path",{d:"M90 47.1c0-3.1-.3-6.3-.8-9.3H45.9v17.7h24.8c-1 5.7-4.3 10.7-9.2 13.9l14.8 11.5C85 72.8 90 61 90 47.1z",fill:"#4280ef"}),e.jsx("path",{d:"M45.9 91.9c12.4 0 22.8-4.1 30.4-11.1L61.5 69.4c-4.1 2.8-9.4 4.4-15.6 4.4-12 0-22.1-8.1-25.8-18.9L4.9 66.6c7.8 15.5 23.6 25.3 41 25.3z",fill:"#34a353"}),e.jsx("path",{d:"M20.1 54.8c-1.9-5.7-1.9-11.9 0-17.6L4.9 25.4c-6.5 13-6.5 28.3 0 41.2l15.2-11.8z",fill:"#f6b704"}),e.jsx("path",{d:"M45.9 18.3c6.5-.1 12.9 2.4 17.6 6.9L76.6 12C68.3 4.2 57.3 0 45.9.1c-17.4 0-33.2 9.8-41 25.3l15.2 11.8c3.7-10.9 13.8-18.9 25.8-18.9z",fill:"#e54335"})]})}const k="googleRedirectAt",N="googleLastPage";function F(m){const{isDisabled:u,setIsDisabled:t}=m,[s,a]=l.useState(!1),[g,c]=l.useState("");l.useEffect(()=>{const o=new URLSearchParams(window.location.search),i=o.get("code"),d=o.get("state"),p=o.get("provider");!i||!d||p!=="google"||(a(!0),t?.(!0),I(`https://api.roadmap.sh/v1-google-callback${window.location.search}`).then(({response:r,error:w})=>{if(!r?.token){c(w?.message||"Something went wrong."),a(!1),t?.(!1);return}let n="/";const x=localStorage.getItem(k),h=localStorage.getItem(N);if(x&&h){const S=parseInt(x,10);Date.now()-S<30*1e3&&(n=h)}const b=localStorage.getItem("authRedirect");b&&(localStorage.removeItem("authRedirect"),n=b),localStorage.removeItem(k),localStorage.removeItem(N),j(r.token),window.location.href=n}).catch(r=>{c("Something went wrong. Please try again later."),a(!1),t?.(!1)}))},[]);const f=()=>{a(!0),t?.(!0),I("https://api.roadmap.sh/v1-google-login").then(({response:o,error:i})=>{if(!o?.loginUrl){c(i?.message||"Something went wrong."),a(!1),t?.(!1);return}if(!["/login","/signup"].includes(window.location.pathname)){const d=["/respond-invite","/befriend","/r","/ai"].includes(window.location.pathname)?window.location.pathname+window.location.search:window.location.pathname;localStorage.setItem(k,Date.now().toString()),localStorage.setItem(N,d)}window.location.href=o.loginUrl}).catch(o=>{c("Something went wrong. Please try again later."),a(!1),t?.(!1)})};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"inline-flex h-10 w-full items-center justify-center gap-2 rounded border border-slate-300 bg-white p-2 text-sm font-medium text-black outline-none focus:ring-2 focus:ring-[#333] focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-60",disabled:s||u,onClick:f,children:[s?e.jsx(L,{className:"h-[18px] w-[18px]",isDualRing:!1}):e.jsx(U,{className:"h-[18px] w-[18px]"}),"Continue with Google"]}),g&&e.jsx("p",{className:"mb-2 mt-1 text-sm font-medium text-red-600",children:g})]})}function T(m){const{className:u}=m;return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:u,x:"0px",y:"0px",width:"100",height:"100",viewBox:"0,0,256,256",children:e.jsx("g",{transform:"translate(-26.66667,-26.66667) scale(1.20833,1.20833)",children:e.jsx("g",{fill:"none",fillRule:"nonzero",stroke:"none",strokeWidth:"1",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:"10",strokeDasharray:"",strokeDashoffset:"0",fontFamily:"none",fontWeight:"none",fontSize:"none",textAnchor:"none",style:{mixBlendMode:"normal"},children:e.jsxs("g",{transform:"scale(5.33333,5.33333)",children:[e.jsx("path",{d:"M42,37c0,2.762 -2.238,5 -5,5h-26c-2.761,0 -5,-2.238 -5,-5v-26c0,-2.762 2.239,-5 5,-5h26c2.762,0 5,2.238 5,5z",fill:"#0288d1"}),e.jsx("path",{d:"M12,19h5v17h-5zM14.485,17h-0.028c-1.492,0 -2.457,-1.112 -2.457,-2.501c0,-1.419 0.995,-2.499 2.514,-2.499c1.521,0 2.458,1.08 2.486,2.499c0,1.388 -0.965,2.501 -2.515,2.501zM36,36h-5v-9.099c0,-2.198 -1.225,-3.698 -3.192,-3.698c-1.501,0 -2.313,1.012 -2.707,1.99c-0.144,0.35 -0.101,1.318 -0.101,1.807v9h-5v-17h5v2.616c0.721,-1.116 1.85,-2.616 4.738,-2.616c3.578,0 6.261,2.25 6.261,7.274l0.001,9.726z",fill:"#ffffff"})]})})})})}const R="linkedInRedirectAt",P="linkedInLastPage";function _(m){const{isDisabled:u,setIsDisabled:t}=m,[s,a]=l.useState(!1),[g,c]=l.useState("");l.useEffect(()=>{const o=new URLSearchParams(window.location.search),i=o.get("code"),d=o.get("state"),p=o.get("provider");!i||!d||p!=="linkedin"||(a(!0),t?.(!0),I(`https://api.roadmap.sh/v1-linkedin-callback${window.location.search}`).then(({response:r,error:w})=>{if(!r?.token){c(w?.message||"Something went wrong."),a(!1),t?.(!1);return}let n="/";const x=localStorage.getItem(R),h=localStorage.getItem(P);if(x&&h){const S=parseInt(x,10);Date.now()-S<30*1e3&&(n=h)}const b=localStorage.getItem("authRedirect");b&&(localStorage.removeItem("authRedirect"),n=b),localStorage.removeItem(R),localStorage.removeItem(P),j(r.token),window.location.href=n}).catch(r=>{c("Something went wrong. Please try again later."),a(!1),t?.(!1)}))},[]);const f=()=>{a(!0),t?.(!0),I("https://api.roadmap.sh/v1-linkedin-login").then(({response:o,error:i})=>{if(!o?.loginUrl){c(i?.message||"Something went wrong."),a(!1),t?.(!1);return}if(!["/login","/signup"].includes(window.location.pathname)){const d=["/respond-invite","/befriend","/r","/ai"].includes(window.location.pathname)?window.location.pathname+window.location.search:window.location.pathname;localStorage.setItem(R,Date.now().toString()),localStorage.setItem(P,d)}window.location.href=o.loginUrl}).catch(o=>{c("Something went wrong. Please try again later."),a(!1),t?.(!1)})};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"inline-flex h-10 w-full items-center justify-center gap-2 rounded border border-slate-300 bg-white p-2 text-sm font-medium text-black outline-none focus:ring-2 focus:ring-[#333] focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-60",disabled:s||u,onClick:f,children:[s?e.jsx(L,{className:"h-[18px] w-[18px]",isDualRing:!1}):e.jsx(T,{className:"h-[18px] w-[18px]"}),"Continue with LinkedIn"]}),g&&e.jsx("p",{className:"mb-2 mt-1 text-sm font-medium text-red-600",children:g})]})}function $(m){const{isDisabled:u,setIsDisabled:t}=m,[s,a]=l.useState(""),[g,c]=l.useState(""),[f,o]=l.useState(""),[i,d]=l.useState(!1),p=async r=>{r.preventDefault(),d(!0),t?.(!0),o("");const{response:w,error:n}=await A("https://api.roadmap.sh/v1-login",{email:s,password:g});if(w?.token){j(w.token),window.location.reload();return}if(n.type==="user_not_verified"){window.location.href=`/verification-pending?email=${encodeURIComponent(s)}`;return}d(!1),t?.(!1),o(n?.message||"Something went wrong. Please try again later.")};return e.jsxs("form",{className:"w-full",onSubmit:p,children:[e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),e.jsx("input",{name:"email",type:"email",autoComplete:"email",required:!0,className:"block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"Email Address",value:s,onInput:r=>a(String(r.target.value))}),e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsx("input",{name:"password",type:"password",autoComplete:"current-password",required:!0,className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"Password",value:g,onInput:r=>c(String(r.target.value))}),e.jsx("p",{className:"mb-3 mt-2 text-sm text-gray-500",children:e.jsx("a",{href:"/forgot-password",className:"text-blue-800 hover:text-blue-600",children:"Reset your password?"})}),f&&e.jsx("p",{className:"mb-2 rounded-md bg-red-100 p-2 text-red-800",children:f}),e.jsx("button",{type:"submit",disabled:i||u,className:"inline-flex w-full items-center justify-center rounded-lg bg-black p-2 py-3 text-sm font-medium text-white outline-none focus:ring-2 focus:ring-black focus:ring-offset-1 disabled:bg-gray-400",children:i?"Please wait...":"Continue"})]})}function B(m){const{isDisabled:u,setIsDisabled:t}=m,[s,a]=l.useState(""),[g,c]=l.useState(""),[f,o]=l.useState(""),[i,d]=l.useState(""),[p,r]=l.useState(!1),w=async n=>{n.preventDefault(),r(!0),t?.(!0),d("");const{response:x,error:h}=await A("https://api.roadmap.sh/v1-register",{email:s,password:g,name:f});if(h||x?.status!=="ok"){r(!1),t?.(!1),d(h?.message||"Something went wrong. Please try again later.");return}window.location.href=`/verification-pending?email=${encodeURIComponent(s)}`};return e.jsxs("form",{className:"flex w-full flex-col gap-2",onSubmit:w,children:[e.jsx("label",{htmlFor:"name",className:"sr-only",children:"Name"}),e.jsx("input",{name:"name",type:"text",autoComplete:"name",min:3,max:50,required:!0,className:"block w-full rounded-lg border border-gray-300 px-3 py-2 outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"Full Name",value:f,onInput:n=>o(String(n.target.value))}),e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),e.jsx("input",{name:"email",type:"email",autoComplete:"email",required:!0,className:"block w-full rounded-lg border border-gray-300 px-3 py-2  outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"Email Address",value:s,onInput:n=>a(String(n.target.value))}),e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsx("input",{name:"password",type:"password",autoComplete:"current-password",min:6,max:50,required:!0,className:"block w-full rounded-lg border border-gray-300 px-3 py-2 outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"Password",value:g,onInput:n=>c(String(n.target.value))}),i&&e.jsxs("p",{className:"rounded-lg bg-red-100 p-2 text-red-700",children:[i,"."]}),e.jsx("button",{type:"submit",disabled:p||u,className:"inline-flex w-full items-center justify-center rounded-lg bg-black p-2 py-3 text-sm font-medium text-white outline-none focus:ring-2 focus:ring-black focus:ring-offset-1 disabled:bg-gray-400",children:p?"Please wait...":"Continue to Verify Email"})]})}function W(m){const{type:u="login"}=m,[t,s]=l.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx(G,{isDisabled:t,setIsDisabled:s}),e.jsx(F,{isDisabled:t,setIsDisabled:s}),e.jsx(_,{isDisabled:t,setIsDisabled:s})]}),e.jsxs("div",{className:"flex w-full items-center gap-2 py-6 text-sm text-slate-600",children:[e.jsx("div",{className:"h-px w-full bg-slate-200"}),"OR",e.jsx("div",{className:"h-px w-full bg-slate-200"})]}),u==="login"?e.jsx($,{isDisabled:t,setIsDisabled:s}):e.jsx(B,{isDisabled:t,setIsDisabled:s})]})}export{W as AuthenticationForm};
