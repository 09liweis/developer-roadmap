import{j as e}from"./jsx-runtime.BPj4-Rfu.js";import{r as p}from"./index.SSXOyoI7.js";import{C as I}from"./CheckIcon.Dy4QWWBd.js";import{a as w}from"./http.BfNEAXh_.js";import{MarkFavorite as C}from"./MarkFavorite.HvKfhUef.js";import{S as $}from"./Spinner.B1Yt5gOc.js";import{CreateRoadmapButton as b}from"./CreateRoadmapButton.kVmcoNmW.js";import{C as E}from"./CreateRoadmapModal.Dc09wQ2A.js";import{M as F}from"./map.B4ShPy-O.js";import{U as S}from"./users-round.BTvwdRzC.js";import{i as k}from"./jwt.DjKu0S3o.js";import"./popup.CdCAhVM2.js";import"./use-toast.CK2mpur1.js";import"./toast.BGQI3kl5.js";import"./index.CEvxOxeV.js";import"./classname.B_pfcvI6.js";import"./bundle-mjs.CpAuaXBl.js";import"./plus.CTO3G_jS.js";import"./createLucideIcon.BSeNqbob.js";import"./Modal.CKHmOEZZ.js";import"./use-outside-click.BWzraQDw.js";import"./use-keydown.DCIacX8c.js";import"./loader-2.BHhQR-Hp.js";function T(a){return e.jsxs("a",{className:"rounded-md border border-dashed border-purple-600 px-3 py-1.5 text-purple-400 transition-colors hover:border-purple-400 hover:text-purple-200",href:"/ai",children:[e.jsx("span",{className:"relative -top-[1px] mr-1 text-xs font-semibold uppercase text-white",children:"New"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Generate visual roadmaps with AI"}),e.jsx("span",{className:"inline text-sm sm:hidden",children:"AI Roadmap Generator!"})]})}function L(a){const{title:s="Start learning ..",message:o="Your progress and favorite roadmaps will show up here."}=a;return e.jsxs("div",{className:"relative flex min-h-full flex-col items-start justify-center py-6 sm:items-center",children:[e.jsxs("h2",{className:"mb-1.5 flex items-center text-lg text-gray-200 sm:text-2xl",children:[e.jsx(I,{additionalClasses:"mr-2 top-[0.5px] w-[16px] h-[16px] sm:w-[20px] sm:h-[20px]"}),s]}),e.jsx("p",{className:"text-sm text-gray-400 sm:text-base",children:o}),e.jsx("p",{className:"mt-5",children:e.jsx(T,{})})]})}function v(a){const{url:s,percentageDone:o,resourceType:i,resourceId:l,resourceTitle:n,isFavorite:c,allowFavorite:x=!0}=a;return e.jsxs("a",{href:s,className:"relative flex flex-col overflow-hidden rounded-md border border-slate-800 bg-slate-900 p-3 text-sm text-slate-400 hover:border-slate-600 hover:text-slate-300",children:[e.jsx("span",{className:"relative z-20",children:n}),e.jsx("span",{className:"absolute bottom-0 left-0 top-0 z-10 bg-[#172a3a]",style:{width:`${o}%`}}),x&&e.jsx(C,{resourceId:l,resourceType:i,favorite:c})]})}function y(a){const{isLoading:s=!1,title:o,icon:i}=a;return e.jsxs("p",{className:"mb-4 flex items-center text-sm text-gray-400",children:[!s&&i,s&&e.jsx("span",{className:"mr-1.5",children:e.jsx($,{})}),o]})}function R(a){const{teamRoadmaps:s={},progress:o,isLoading:i=!1,customRoadmaps:l}=a,[n,c]=p.useState(!1),[x,h]=p.useState();return e.jsxs("div",{className:"relative pb-12 pt-4 sm:pt-7",children:[e.jsx("p",{className:"mb-7 mt-2 text-sm",children:e.jsx(T,{})}),n&&e.jsx(E,{teamId:x,onClose:()=>{c(!1),h(void 0)}}),e.jsx(y,{icon:e.jsx(I,{additionalClasses:"mr-1.5 h-[14px] w-[14px]"}),isLoading:i,title:"Your progress and favorite roadmaps."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:o.map(r=>e.jsx(v,{resourceId:r.resourceId,resourceType:r.resourceType,resourceTitle:r.resourceTitle,isFavorite:r.isFavorite,percentageDone:(r.skipped+r.done)/r.total*100,url:r.resourceType==="roadmap"?`/${r.resourceId}`:`/best-practices/${r.resourceId}`},`${r.resourceType}-${r.resourceId}`))}),e.jsxs("div",{className:"mt-5",children:[e.jsx(y,{icon:e.jsx(F,{className:"mr-1.5 h-[14px] w-[14px]"}),title:"Your custom roadmaps"}),l.length===0&&e.jsxs("p",{className:"rounded-md border border-dashed border-gray-800 p-2 text-sm text-gray-600",children:["You haven't created any custom roadmaps yet."," ",e.jsx("button",{className:"text-gray-500 underline underline-offset-2 hover:text-gray-400",onClick:()=>c(!0),children:"Create one!"})]}),l.length>0&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:[l.map(r=>e.jsx(v,{resourceId:r.resourceId,resourceType:"roadmap",resourceTitle:r.resourceTitle,percentageDone:(r.skipped+r.done)/r.total*100,url:`/r?id=${r.resourceId}`,allowFavorite:!1},r.resourceId)),e.jsx(b,{})]})]}),Object.keys(s).map(r=>{const m=s?.[r]?.[0]?.team,u=s[r].filter(d=>!!d.resourceTitle),f=["admin","manager"].includes(m?.role);return e.jsxs("div",{className:"mt-5",children:[e.jsx(y,{icon:e.jsx(S,{className:"mr-1.5 h-[14px] w-[14px]"}),title:e.jsxs(e.Fragment,{children:["Team"," ",e.jsx("a",{className:"mx-1 font-medium underline underline-offset-2 transition-colors hover:text-gray-300",href:`/team/progress?t=${m?.id}`,children:r}),"Roadmaps"]})}),u.length===0&&e.jsxs("p",{className:"rounded-md border border-dashed border-gray-800 p-2 text-sm text-gray-600",children:["Team does not have any roadmaps yet."," ",f&&e.jsx("button",{className:"text-gray-500 underline underline-offset-2 hover:text-gray-400",onClick:()=>{h(m?.id),c(!0)},children:"Create one!"})]}),u.length>0&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:[u.map(d=>e.jsx(v,{resourceId:d.resourceId,resourceType:"roadmap",resourceTitle:d.resourceTitle,percentageDone:(d.skipped+d.done)/d.total*100,url:`/r?id=${d.resourceId}`,allowFavorite:!1},d.resourceId)),f&&e.jsx(b,{teamId:m?.id,text:"Create Team Roadmap"})]})]},r)})]})}function P(a){a.forEach(s=>{const o=s.resourceType==="best-practice"?`/best-practices/${s.resourceId}`:`/${s.resourceId}`,i=document.querySelector(`a[href="${o}"]`);if(!i)return;window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceId:s.resourceId,resourceType:s.resourceType,isFavorite:s.isFavorite}}));const n=(s.done+s.skipped)/s.total*100,c=i.querySelector("[data-progress]");c&&(c.style.width=`${n}%`)})}function ae(){if(!k())return null;const[s,o]=p.useState(!0),[i,l]=p.useState(!0),[n,c]=p.useState([]),[x,h]=p.useState(0);function r(){const t=document.getElementById("hero-text");t&&(t.classList.add("opacity-0"),setTimeout(()=>{t.parentElement?.removeChild(t),o(!1),setTimeout(()=>{h(100)},50)},0))}async function m(){l(!0);const{response:t,error:g}=await w("https://api.roadmap.sh/v1-get-hero-roadmaps");g||!t||(c(t),l(!1),r(),P(t))}if(p.useEffect(()=>{m().finally(()=>{l(!1)})},[]),p.useEffect(()=>(window.addEventListener("refresh-favorites",m),()=>window.removeEventListener("refresh-favorites",m)),[]),s)return null;const u=n?.length>0,f=n?.filter(t=>t.isCustomResource&&!t.team?.name),d=n?.filter(t=>!t.isCustomResource),N=n?.filter(t=>t.isCustomResource&&t.team?.name).reduce((t,g)=>{const j=g.team;return t[j.name]||(t[j.name]=[]),t[j.name].push(g),t},{});return e.jsx("div",{className:`transition-opacity duration-500  opacity-${x}`,children:e.jsx("div",{className:`flex min-h-[192px] bg-gradient-to-b sm:min-h-[280px] ${u&&"border-t border-t-[#1e293c]"}`,children:e.jsxs("div",{className:"container min-h-full",children:[!i&&n?.length==0&&e.jsx(L,{}),u&&e.jsx(R,{teamRoadmaps:N,customRoadmaps:f,progress:d,isLoading:i})]})})})}export{ae as FavoriteRoadmaps};
