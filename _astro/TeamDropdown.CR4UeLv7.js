import{j as e}from"./jsx-runtime.BPj4-Rfu.js";import{r as a}from"./index.SSXOyoI7.js";import{a as y}from"./http.BfNEAXh_.js";import{u as S}from"./use-auth.Bku_Ubkw.js";import{u as I}from"./use-outside-click.BWzraQDw.js";import{S as $}from"./Spinner.B1Yt5gOc.js";import{a as h,c as g}from"./team.B3mFytyj.js";import{u as j}from"./index.zDCl-MiS.js";import{u as C}from"./use-team-id.zchX2nIl.js";import{u as L}from"./use-toast.CK2mpur1.js";import{D}from"./DropdownIcon.CrhLO9Zb.js";import"./jwt.DjKu0S3o.js";import"./index.Bhz7cRIx.js";import"./index.CEvxOxeV.js";import"./toast.BGQI3kl5.js";import"./classname.B_pfcvI6.js";import"./bundle-mjs.CpAuaXBl.js";function U(){const m=S(),{teamId:i}=C(),[w,v]=a.useState(!1);a.useEffect(()=>{const t=localStorage.getItem("viewedTeamsCount"),s=parseInt(t||"0",10),x=s<5;v(x),x&&localStorage.setItem("viewedTeamsCount",(s+1).toString())},[]);const r=j(g),n=j(h),b=L(),c=a.useRef(null),[o,d]=a.useState(!0),[u,p]=a.useState(!1),f=n?n.avatar:m?.avatar,N=n?n.name:m?.name;I(c,()=>{p(!1)});async function T(){const{response:t,error:s}=await y("https://api.roadmap.sh/v1-get-user-teams");if(s||!t){b.error(s?.message||"Something went wrong");return}g.set(t)}a.useEffect(()=>{!i||!r||h.set(r.find(t=>t._id===i))},[r,i]),a.useEffect(()=>{d(!0),T().finally(()=>{d(!1)})},[]);const l=r.filter(t=>t.status==="invited").map(t=>t._id);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mr-2",children:[e.jsxs("span",{className:"mb-2 flex items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{children:"Choose Team"}),w&&e.jsx("span",{className:"mr-1 inline-flex h-1 w-1 items-center justify-center font-medium text-blue-300",children:e.jsxs("span",{className:"relative flex items-center",children:[e.jsx("span",{className:"relative rounded-full bg-gray-200 p-1 text-xs"}),e.jsx("span",{className:"absolute bottom-0 left-0 right-0 top-0 animate-ping rounded-full bg-gray-400 p-1 text-xs"})]})})]}),e.jsxs("button",{className:"relative flex w-full cursor-pointer items-center justify-between rounded border p-2 text-sm hover:bg-gray-100",onClick:()=>p(!u),children:[l.length>0&&e.jsx("span",{className:"absolute -left-1.5 -top-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-xs font-medium text-white",children:l.length}),e.jsxs("div",{className:"mr-1.5 inline-grid grid-cols-[16px_auto] items-center gap-1.5",children:[o&&e.jsx($,{className:"h-4 w-4",isDualRing:!1}),!o&&e.jsx("img",{src:f?`https://dodrc8eu8m09s.cloudfront.net/avatars/${f}`:"/images/default-avatar.png",alt:"",className:"h-4 w-4 rounded-full object-cover"}),e.jsxs("span",{className:"truncate",children:[!o&&N,o&&"Loading .."]})]}),e.jsx(D,{className:"h-4 w-4"})]}),u&&e.jsxs("div",{ref:c,className:"absolute top-full z-50 mt-2 w-full rounded-md bg-slate-800 px-2 py-2 text-white shadow-md",children:[e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("a",{className:"flex w-full cursor-pointer items-center gap-2 truncate rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",href:"/account",children:e.jsx("span",{className:"truncate",children:"Personal Account"})})}),r.map(t=>{let s="";return t.status==="invited"?s=`/respond-invite?i=${t.memberId}`:t.status==="joined"&&(s=`/team/progress?t=${t._id}`),e.jsx("li",{children:e.jsxs("a",{className:"flex w-full cursor-pointer items-center gap-2 rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",href:`${s}`,children:[e.jsx("span",{className:"min-w-0 flex-grow truncate",children:t.name}),l.includes(t._id)&&e.jsx("span",{className:"flex rounded-md bg-red-500 px-2 text-xs text-white",children:"Invite"})]})},t?._id)})]}),e.jsxs("a",{className:"mt-2 flex w-full cursor-pointer items-center justify-center gap-2 rounded bg-gray-100 p-2 text-sm font-medium text-slate-800 hover:opacity-90",href:"/team/new",children:[e.jsx("span",{children:"+"}),e.jsx("span",{children:"New Team"})]})]})]}),e.jsx("hr",{className:"my-4"})]})}export{U as TeamDropdown};
